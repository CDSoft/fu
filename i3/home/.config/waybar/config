// vim: set filetype=jsonc:
%(  (function()
        local sh = require "sh"
        local function getpart(path)
            local part = sh { "df -P", path, "2>/dev/null" }
            if part then return part : lines() : last() : words() : head() end
        end
        partition_root = getpart "/"
        partition_home = getpart(os.getenv"HOME")
        partition_hd   = getpart "/home/hd"
        partition_tmp  = getpart "/tmp"
        return ""
    end)()
)
{
    "layer": "bottom",
    "position": "bottom",
    "spacing": 4,
    "modules-left": [
        "sway/workspaces",
        "sway/mode",
        "sway/scratchpad"
    ],
    "modules-center": [
        "sway/window"
    ],
    "modules-right": [
        "disk#root",
        %(when(partition_tmp==partition_root) "//")"disk#tmp",
        %(when(partition_home==partition_root)"//")"disk#home",
        %(when(not partition_hd or partition_hd==partition_root)"//")"disk#hd",
        "bluetooth",
        "network",
        "cpu",
        "memory",
        "temperature",
        "battery",
        "idle_inhibitor",
        "sway/language",
        "keyboard-state",
        "pulseaudio",
        "tray",
        "clock"
        //"custom/power"
    ],
    "battery": {
        "interval": 30,
        "states": {
            "good": 90,
            "warning": 30,
            "critical": 15
        },
        "format": "{capacity:3d}% {icon}",
        "format-icons": ["ÔâÑ", "ÔâÉ", "ÔâÇ", "ÔâÅ", "ÔâÄ"]
    },
    "bluetooth": {
        "format": "Ôäî {status}",
        "format-connected": "Ôäî {device_alias}",
        "format-connected-battery": "Ôäî {device_alias} {device_battery_percentage}%",
        "format-no-controller": "",
        "tooltip-format": "{controller_alias}\t{controller_address}\n\n{num_connections} connected",
        "tooltip-format-connected": "{controller_alias}\t{controller_address}\n\n{num_connections} connected\n\n{device_enumerate}",
        "tooltip-format-enumerate-connected": "{device_alias}\t{device_address}",
        "tooltip-format-enumerate-connected-battery": "{device_alias}\t{device_address}\t{device_battery_percentage}%",
        "on-click": "blueman-manager"
    },
    "clock": {
        "timezone": "%(TIMEZONE)",
        "format": "{:%d/%m - %H:%M} ÔÄó ",
        "tooltip-format": "<tt>{calendar}</tt>",
        "calendar": {
            "format": {
                "months":     "<span color='#ffead3'><b>{}</b></span>",
                "days":       "<span color='#ecc6d9'><b>{}</b></span>",
                "weeks":      "<span color='#99ffdd'><b>W{}</b></span>",
                "weekdays":   "<span color='#ffcc66'><b>{}</b></span>",
                "today":      "<span color='#ff6699'><b><u>{}</u></b></span>"
            }
        },
        "on-click": "gnome-clocks"
    },
    "cpu": {
        "interval": 5,
        "format": "{usage:3d}% {avg_frequency:3.1f}GHz {load:5.2f} Ôãõ",
        "on-click": "st btop"
    },
    "disk#root": {
        "path": "/",
        "interval": 30,
        "format": "üñ¥ / {free}",
        "on-click": "alacritty -e vifm / ~"
    },
    "disk#home": {
        "path": "%(HOME)",
        "interval": 30,
        "format": "üñ¥ ~ {free}",
        "on-click": "alacritty -e vifm ~ ~"
    },
    "disk#hd": {
        "path": "/home/hd",
        "interval": 30,
        "format": "üñ¥ hd {free}",
        "on-click": "alacritty -e vifm /home/hd ~"
    },
    "disk#tmp": {
        "path": "/tmp",
        "interval": 30,
        "format": "üñ¥ tmp {free}",
        "on-click": "alacritty -e vifm /tmp ~"
    },
    "idle_inhibitor": {
        "format": "{icon}",
        "format-icons": {
            "activated": "ÔÅÆ",
            "deactivated": "ÔÅ∞"
        },
        "timeout": 60.5 // minutes
    },
    "keyboard-state": {
        "numlock": true,
        "capslock": true,
        "scrolllock": false,
        "format": {
            "numlock": "Num {icon}",
            "capslock": "Maj {icon}",
            "scrolllock": "Scroll {icon}"
        },
        "format-icons": {
            "locked": "‚ú∏",
            "unlocked": " "
        }
    },
    "memory": {
        "interval": 5,
        "format": "{avail:4.1f}G ÔÉâ",
        "on-click": "st btop"
    },
    "network": {
        "format": "{ifname} {ipaddr}",
        "format-wifi": "{essid} {ipaddr} ({signalStrength}%) Ôá´",
        "format-ethernet": "{ifname} {ipaddr} ÔÉÅ",
        "format-disconnected": "ÔÅ≤",
        "tooltip-format": "{ifname} {ipaddr}",
        "tooltip-format-wifi": "{essid} {ipaddr} ({signalStrength}%) Ôá´",
        "tooltip-format-ethernet": "{ifname} {ipaddr} ÔÉÅ",
        "tooltip-format-disconnected": "Disconnected"
    },
    "pulseaudio": {
        "format": "{volume}% {icon}",
        "format-bluetooth": "{volume}% {icon}Ôäî {format_source}",
        "format-bluetooth-muted": "Ôö© {icon}Ôäî {format_source}",
        "format-muted": "üîá {format_source}",
        "format-source": "{volume}% ÔÑ∞",
        "format-source-muted": "ÔÑ±",
        "format-icons": {
            "headphones": "ÔÄ•",
            "handsfree": "Ôñê",
            "headset": "Ôñê",
            "phone": "ÔÇï",
            "phone-muted": "Ó¥ó",
            "portable": "ÔÇï",
            "car": "ÔÜπ",
            "default": ["ÔÄ¶", "ÔÄß", "ÔÄ®"]
        },
        "scroll-step": 1,
        //"on-click": "pavucontrol"
        "on-click": "pactl set-sink-mute \\@DEFAULT_SINK@ toggle",
        "on-click-right": "pavucontrol"
    },
    "sway/mode": {
        //"format": "<span style=\"italic\">{}</span>"
    },
    "sway/scratchpad": {
        "format": "{icon} {count}",
        "show-empty": false,
        "format-icons": ["", "Ôãí"],
        "tooltip": true,
        "tooltip-format": "{app}: {title}"
    },
    "sway/window": {
        "format": "{}",
        "max-length": 50,
        "rewrite": {
            "(.*) - Mozilla Firefox": "üåé $1",
            "(.*) - zsh": "> [$1]"
        },
        "on-click": "st -c fzf -g 128x32 -f \"%(FONT:gsub(' ', '')):pixelsize=%(FONT_SIZE*16//9)\" fzf-launcher.lua"
    },
    "sway/workspaces": {
        "format": "{value}",
        "disable-scroll-wraparound": true,
        "enable-bar-scroll": true,
        "disable-auto-back-and-forth": true,
    },
    "temperature": {
        "format": "{temperatureC:2d}¬∞C Ôãâ"
    },
    "tray": {
         "icon-size": %(FONT_SIZE*2),
        "spacing": 8,
        "show-passive-items": true,
    },
    "custom/power": {
        "format" : "‚èª ",
        "tooltip": false,
        "menu": "on-click",
        "menu-file": "$HOME/.config/waybar/power_menu.xml",
        "menu-actions": {
            "shutdown": "shutdown",
            "reboot": "reboot",
            "suspend": "systemctl suspend",
            "hibernate": "systemctl hibernate"
        }
    }
}
